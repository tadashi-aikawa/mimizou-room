---
description: TypeScript2.7ã®ãƒªãƒªãƒ¼ã‚¹å†…å®¹ã¾ã¨ã‚
---

# [TypeScript] 2.7

{{ page.meta.description }}


## [Constant-named properties]

[Constant-named properties]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#constant-named-properties

{{label('had_better')}} {{label('easy')}}

Symbolã‚’å«ã‚€ã€constã§å®£è¨€ã•ã‚ŒãŸå¤‰æ•°ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã«å¯¾å¿œã—ãŸã€‚

```typescript
const hoge = Symbol("hogehoge");

const obj = {
    [hoge]: "value"
}

// obj.ã§è£œå®Œå€™è£œãŒå‡ºç¾ã—ã€obj[hoge]ã¯stringã¨æ¨è«–ã•ã‚Œã‚‹
const str = obj[hoge]
```

stringã‚„numberã®å ´åˆã‚‚åŒæ§˜ã ãŒã€ä»¥å‰ã¯å¯¾å¿œã—ã¦ã„ãªã‹ã£ãŸã®ã‹ã¯è¬ã€‚ã€‚


## [unique symbol]

[unique symbol]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#unique-symbol

{{label('had_better')}} {{label('normal')}}

`symbol`ã®ã‚µãƒ–ã‚¿ã‚¤ãƒ—ã¨ã—ã¦`unique symobl`å‹ãŒè¿½åŠ ã•ã‚ŒãŸã€‚  
ä¸€æ„æ€§ãŒä¿è¨¼ã•ã‚Œã¦ãŠã‚Šã€**ä»£å…¥ã‚„æ¯”è¼ƒãŒã§ããªã„**ã¨ã„ã†ç‰¹å¾´ãŒã‚ã‚‹ã€‚

åˆ©ç”¨ã§ãã‚‹ã‚·ãƒ¼ãƒ³/ã§ããªã„ã‚·ãƒ¼ãƒ³ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

| ã‚·ãƒ¼ãƒ³                                                   | unique symbol?    | ã‚³ãƒ¼ãƒ‰ä¾‹                                              |
| -------------------------------------------------------- | ----------------- | ----------------------------------------------------- |
| `const`ã§æ˜ç¤ºçš„ã«å®£è¨€                                    | **unique symbol** | `declare const x: unique symbol;`                     |
| `const`ã§`Symbol()`ã‚’ä»£å…¥                                | **unique symbol** | `const x = Symbol();`                                 |
| æ˜ç¤ºçš„ã«`Symbol()`ã‚’ä»£å…¥                                 | **unique symbol** | `let x: unique symbol = Symbol();`                    |
| æ˜ç¤ºçš„ã«`Symbol.for()`ã‚’ä»£å…¥                             | **unique symbol** | `let x: unique symbol = Symbol.for("key");`           |
| `static readonly`ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«`Symbol()`ã‚’ä»£å…¥          | **unique symbol** | `class Inf { static readonly x = Symbol() }`          |
| `const`ã§`Symbol.for()`ã‚’ä»£å…¥                            | symbol            | `const x = Symbol.for("key");`                        |
| `static readonly`ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«`Symbol.for("key")`ã‚’ä»£å…¥ | symbol            | `class Inf { static readonly x = Symbol.for("key") }` |
| `let`ã§æ˜ç¤ºçš„ã«å®£è¨€                                      | ã‚¨ãƒ©ãƒ¼            | `declare const x: unique symbol;`                     |

åˆ©ç”¨ä¾‹ã¨ã—ã¦ã€Nominal Typingã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ä»˜ä¸ã™ã‚‹ä¸€æ„ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãªã©ãŒè€ƒãˆã‚‰ã‚Œã‚‹ã€‚

=== "Structural Typing"
    ```typescript
    class Dog {
        constructor(public name: string) { }
    }

    class Cat {
        constructor(public name: string) { }
    }

    function nyan(cat: Cat) {
        console.log(cat.name);
    }

    const dog = new Dog("pochi");

    // å¼•æ•°ã¯Catã ãŒdog(: Dog)ã¯Catã¨åŒã˜ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤ãŸã‚å‹•ä½œã™ã‚‹
    nyan(dog);
    ```

=== "Nominal Typing"
    ```typescript
    const DogType = Symbol();
    class Dog {
        private [DogType]: void;
        constructor(public name: string) { }
    }

    const CatType = Symbol();
    class Cat {
        private [CatType]: void;
        constructor(public name: string) { }
    }

    function nyan(cat: Cat) {
        console.log(cat.name);
    }

    const dog = new Dog("pochi");

    // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒé•ã†ã®ã§ã¡ã‚ƒã‚“ã¨ã‚¨ãƒ©ãƒ¼ã«ã—ã¦ãã‚Œã‚‹
    // TS2345: Argument of type 'Dog' is not assignable to parameter of type 'Cat'.
    // Property '[CatType]' is missing in type 'Dog' but required in type 'Cat'.
    nyan(dog);
    ```
    
## [Strict Class Initialization]

[Strict Class Initialization]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#strict-class-initialization

{{label('should')}} {{label('easy')}}

`--strictPropertyInitialization`ãƒ•ãƒ©ã‚°ãŒè¿½åŠ ã•ã‚ŒãŸã€‚  
æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§åˆæœŸåŒ–ã•ã‚Œã¦ã„ãªã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚  

```typescript
class Human {
    id: number;  // <--- ã“ã‚ŒãŒã‚¨ãƒ©ãƒ¼ã«ãªã‚‹. number | undefined ã«ã™ã‚‹ã‹åˆæœŸåŒ–ã™ã¹ã
    name: string;
    
    constructor(name: string) {
        this.name = name
    }
}
```

Injectionãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã©ã§ä¸Šè¨˜æŒ™å‹•ãŒå¥½ã¾ã—ããªã„å ´åˆã€`!`ã‚’ä»˜ã‘ã‚‹ã“ã¨ã§å›é¿ã§ãã‚‹ã€‚

```typescript
class Human {
    id!: number;  // ã“ã‚Œã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„
    name: string;
    
    constructor(name: string) {
        this.name = name
    }
}
```

`--strictPropertyInitialization`ãƒ•ãƒ©ã‚°ã¯`--strict`ãƒ¢ãƒ¼ãƒ‰ã§ã‚ã‚Œã°è‡ªå‹•ã§æœ‰åŠ¹ã«ãªã‚‹ã€‚  
`--strict`ãƒ¢ãƒ¼ãƒ‰ã§ã‚‚ã€`--strictPropertyInitialization`ãƒ•ãƒ©ã‚°ã‚’æ˜ç¤ºçš„ã«OFFã«ã™ã‚‹ã¨ã€ã“ã®ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã‚’å¤–ã™ã“ã¨ãŒã§ãã‚‹ã€‚

## [Definite Assignment Assertions]

[Definite Assignment Assertions]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#definite-assignment-assertions

{{label('should')}} {{label('easy')}}

ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã‚„å¤‰æ•°åã®ã‚ã¨ã«`!`ã‚’ã¤ã‘ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ã‹ã‚‰åˆ¤åˆ¥ã§ããªãã¦ã‚‚ã€å€¤ãŒä»£å…¥ã•ã‚Œã¦ã„ã‚‹ã€ã¨ã¿ãªã›ã‚‹ã€‚  
åˆ¥ã®è¨€ã„æ–¹ã‚’ã™ã‚‹ã¨`non-null`ã§ã‚ã‚‹ã“ã¨ã‚’ä¿è¨¼ã§ãã‚‹ã€‚

```typescript
function sum(x: number, y: number): number {
  return x + y;
}

const x = 1;
let y: number;

// `y` ã ã¨ä»£å…¥å‰ã®åˆ©ç”¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ãŒã€`y!`ã ã¨OK
sum(x, y!)
```


## [Fixed Length Tuples]

[Fixed Length Tuples]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#definite-assignment-assertions

{{label('had_better')}} {{label('easy')}}

è¦ç´ ã®å‹ãŒåŒ…å«ã•ã‚Œã¦ã„ã‚‹é•·ã•ã®é•ã†Tupleã«ä»£å…¥ã§ããªããªã£ãŸã€‚

ä»¥å‰ã¯`[A, B]`ã‚’`[A, B, C]`ã®ã‚µãƒ–ã‚¿ã‚¤ãƒ—ã¨è¦‹ãªã—ã¦ã„ãŸãŒã€`length`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®é•ã„ã‹ã‚‰ãã†è¦‹ãªã•ãªããªã£ãŸã€‚

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | [A, B, C] <- [A, B] | [A, B] <- [A, B, C] |
| ---------- | ------------------- | ------------------- |
| v2.6ä»¥å‰   | ã‚¨ãƒ©ãƒ¼              | **OK**              |
| v2.7ä»¥é™   | ã‚¨ãƒ©ãƒ¼              | **ã‚¨ãƒ©ãƒ¼**          |

```typescript
const child: [number, string, string] = [1, "one", "ichi"];
// ä»¥å‰ã¯OKã ã£ãŸãŒã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
const parent: [number, string] = child;
```

## [Improved type inference for object literals]

[Improved type inference for object literals]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#improved-type-inference-for-object-literals

{{label('had_better')}} {{label('easy')}}

ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒ†ãƒ©ãƒ«ã®å‹æ¨è«–ãŒæ”¹å–„ã•ã‚ŒãŸã€‚

```typescript
const obj = test ? { text: "hello" } : {};
```

v2.6ä»¥å‰ã ã¨`obj.text`ã¯ã‚¨ãƒ©ãƒ¼ã«ãªã£ãŸãŒã€v2.7ä»¥é™ã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„ã€‚

## [Improved handling of structurally identical classes and instanceof expressions]

[Improved handling of structurally identical classes and instanceof expressions]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#improved-handling-of-structurally-identical-classes-and-instanceof-expressions

{{label('had_better')}} {{label('normal')}}

æ§‹é€ çš„ã«ä¸€è‡´ã™ã‚‹ã‚¯ãƒ©ã‚¹ã®åˆ¤å®šã¨`instanceof`å¼ã®æŒ™å‹•ãŒæ”¹å–„ã•ã‚ŒãŸã€‚  
ã‚¯ãƒ©ã‚¹åˆ¤å®šã‚’è¡Œã†ã¨ãã€æ§‹é€ çš„ã«subtypeã‹ã©ã†ã‹ã§ã¯ãªãã‚¯ãƒ©ã‚¹ã®ç¶™æ‰¿é–¢ä¿‚ã‚’è¦‹ã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

ä»¥ä¸‹ã®4ã‚¯ãƒ©ã‚¹ã«ã¤ã„ã¦

```typescript
class A {
    id!: number
}

class AChild extends A {
    name!: string
}

class AChild2 extends A {
    name!: string
}

class ALike {
    id!: number
}
```

| å¼                                     | v2.6ä»¥å‰ã®æ¨è«–å‹ | v2.7ä»¥é™ã®æ¨è«–å‹        | å‚™è€ƒ           |
| -------------------------------------- | ---------------- | ----------------------- | -------------- |
| `!true ? new A() : new AChild()`       | `A`              | `A`                     | è¦ªå­ãªã‚‰è¦ªã¸   |
| `!true ? new AChild() : new AChild2()` | `AChild`         | **`AChild â”ƒ AChild2`** | è¦ªå­é–¢ä¿‚ã¯ãªã„ |
| `!true ? new Alike() : new A()`        | `ALike`          | **`ALike â”ƒ A`**        | è¦ªå­é–¢ä¿‚ã¯ãªã„ |

ã¾ãŸã€é–¢æ•°ã®ä¸­ã§`instanceof`ã§TypeGuardã‚’è¡Œã†ã¨..

```
function ff(a: AChild | AChild2) {
    if (a instanceof AChild) {
        // v2.6ä»¥å‰ã ã¨ a ã¯ `AChild | AChild2`
        // v2.7ä»¥é™ã ã¨ a ã¯ `AChild`
    }
}
```

## [Type guards inferred from in operator]

[Type guards inferred from in operator]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#type-guards-inferred-from--in-operator

{{label('had_better')}} {{label('easy')}}

Objectã«ç‰¹å®šãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹`in`å¼ãŒã€Type Guardã«å¯¾å¿œã—ãŸã€‚

```typescript
interface Human {
    myNo: number;
    name: string;
}

interface Dog {
    name: string
}

function getMyNo(entity: Human | Dog): number {
    if ("myNo" in entity) {
        // entityã¯Humanå‹ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹
        return entity.myNo;
    }

    // entityã¯Dogå‹ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹
    throw new Error(`${entity.name} ã« ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“.`)
}
```

## [Support for import d from "cjs" from CommonJS modules with --esModuleInterop]

[Support for import d from "cjs" from CommonJS modules with --esModuleInterop]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#support-for-import-d-from-cjs-from-commonjs-modules-with---esmoduleinterop

`--esModuleInterop`ãƒ•ãƒ©ã‚°ã‚’ä½¿ã†ã¨CommonJS moduleã‚’`import d from "cjs"`ã®å½¢ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚  

* `import * as foo from "foo"` ã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
* CommonJS/AMD/UMDã‹ã‚‰ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒè¨±å¯ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸ

!!! question "ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã£ã¦æœ€è¿‘ã§ã¯éæ¨å¥¨ã ã£ãŸã‚ˆã†ãªæ°—ã‚‚ã€‚ã€‚ğŸ¤”"

## [Numeric separators]

[Numeric separators]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#numeric-separators

{{label('had_better')}} {{label('easy')}}

æ•°å­—ã‚’ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã§åŒºåˆ‡ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚  
10é€²æ•°ä»¥å¤–ã‚’ä½¿ã†å ´åˆã¯åˆ†ã‹ã‚Šã‚„ã™ã„ã€‚

* `1_000_000`
* `1_0_0_0_0`
* `0xFF_AA_BB_3C`
* `0b0001_0010_0100_1000`


## [Cleaner output in --watch mode]

[Cleaner output in --watch mode]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#cleaner-output-in---watch-mode

{{label('not_necessary')}} {{label('easy')}}

`--watch`ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã€å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸã‚‰ç”»é¢ãŒã‚¯ãƒªã‚¢ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚


## [Prettier --pretty output]

[Prettier --pretty output]: https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#prettier---pretty-output

{{label('not_necessary')}} {{label('easy')}}

ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã‚„ã™ããªã‚‹ã€‚

â€» å¾Œã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ‰åŠ¹ã«ãªã‚‹ã®ã§æ°—ã«ã—ãªãã¦ã‚‚ã‚ˆã„

=== "--pretty ãªã—"
    ```
    main.ts(5,1): error TS2554: Expected 2 arguments, but got 0.
    ```

=== "--pretty ã‚ã‚Š"
    ```
    main.ts:5:1 - error TS2554: Expected 2 arguments, but got 0.
    
    5 sum()
      ~~~~~
    
      main.ts:1:14
        1 function sum(x: number, y: number): number {
                       ~~~~~~~~~
        An argument for 'x' was not provided.
    
    
    Found 1 error.
    ```
    â€» å®Ÿéš›ã¯è‰²ãŒã¤ã
    


